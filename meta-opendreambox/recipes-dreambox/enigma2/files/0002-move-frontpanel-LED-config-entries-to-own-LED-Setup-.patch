From 26aa0064a20c8ba1a6fef548d1a1514c29d0cefa Mon Sep 17 00:00:00 2001
From: ghost <andreas.monzner@dream-property.net>
Date: Sat, 19 Sep 2020 22:37:26 +0200
Subject: [PATCH] move frontpanel LED config entries to own LED Setup (dreamone
 doesn't have a LCD)

---
 usr/share/enigma2/menu.xml                       | 1 +
 usr/share/enigma2/setup.xml                      | 2 ++
 usr/lib/enigma2/python/Components/SystemInfo.py | 2 ++
 3 files changed, 5 insertions(+)

diff --git ausr/share/enigma2/menu.xml b/usr/share/enigma2/menu.xml
index ab26fee..2c977f3 100644
--- a/usr/share/enigma2/menu.xml
+++ b/usr/share/enigma2/menu.xml
@@ -44,6 +44,7 @@
 				<item weight="10" level="0" text= "Animations" entryID="animation_setup" description="Setup UI animations"><screen module="AnimationSetup" screen="AnimationSetup" /></item>
 				<item weight="20" level="0" entryID="av_setup" description="Fine tuning for your Audio and Video settings."><setup id="avsetup"/></item>
 				<item weight="30" requires="Display" entryID="display_setup" description="Configure your frontpanel OLED or LCD display."><setup level="1" id="lcd" /></item>
+				<item weight="40" requires="FrontpanelLEDColorControl" entryID="led_setup" description="Configure your frontpanel LED."><setup level="1" id="led" /></item>
 			</menu>
 
 			<menu weight="40" level="0" text="Devices" entryID="devices_selection" description="Storage, Common Interface, Input, ...">
diff --git a/usr/share/enigma2/setup.xml b/usr/share/enigma2/setup.xml
index c35e1fb..b0ebec9 100644
--- a/usr/share/enigma2/setup.xml
+++ b/usr/share/enigma2/setup.xml
@@ -98,6 +98,8 @@
 			<item level="0" text="Brightness">config.lcd.bright</item>
 			<item level="0" text="Contrast">config.lcd.contrast</item>
 			<item level="0" text="Idle Mode">config.lcd.standby</item>
+		</setup>
+		<setup key="led" title="LED Setup" requires="FrontpanelLEDColorControl">
 			<item level="0" text="LED"></item>
 			<item level="0" text="Color">config.fp.led.default_color</item>
 			<item level="0" text="Brightness">config.fp.led.default_brightness</item>
diff --git a/usr/lib/enigma2/python/Components/SystemInfo.py b/usr/lib/enigma2/python/Components/SystemInfo.py
index 0a3324e..bf086fb 100644
--- a/usr/lib/enigma2/python/Components/SystemInfo.py
+++ b/usr/lib/enigma2/python/Components/SystemInfo.py
@@ -34,6 +34,8 @@ try:
 except:
 	SystemInfo["NetworkManager"] = False
 
+SystemInfo["FrontpanelLEDColorControl"] = fileExists("/proc/stb/fp/led_color")
+
 device_name = HardwareInfo().device_name
 SystemInfo["HaveTouchSensor"] = device_name in ('dm520', 'dm525', 'dm900', 'dm920')
 brightnessLut = {
-- 
2.1.4

